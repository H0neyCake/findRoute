private _allMapPoints = [[[1713.18,5006.53,0],[[1717.82,5023.93,0]]],[[1867.43,5702.53,0],[[1882.17,5699.04,0]]],[[1929.41,3572.57,0],[[1939.67,3577.99,0]]],[[2011.68,2697.81,0],[[2019.98,2691.52,0]]],[[1990.31,4179,0],[[2002.61,4177.8,0]]],[[2024.12,5169.04,0],[[2027.16,5183.81,0]]],[[2062.09,5353.24,0],[[2067.1,5377.55,0],[2057.24,5329.7,0],[2059.71,5356.78,0]]],[[2059.19,5829.69,0],[[2066.27,5828.02,0]]],[[2124.41,1924.48,0],[[2135.3,1937.26,0]]],[[2123.86,5652.32,0],[[2128.34,5673.95,0],[2119.16,5629.61,0],[2119.07,5644.36,0]]],[[2167.42,4713.82,0],[[2176.71,4706.02,0]]],[[2155.93,5351.09,0],[[2157.07,5371.02,0]]],[[2158.79,5807.3,0],[[2185.07,5801.39,0],[2129.95,5813.73,0],[2155.78,5804.92,0]]],[[2191.12,5694.54,0],[[2197.11,5725.86,0],[2184.87,5661.99,0],[2197,5701.87,0]]],[[2209.99,5795.68,0],[[2234.15,5790.17,0],[2185.07,5801.39,0],[2209.59,5792.98,0]]],[[2247.32,5691.51,0],[[2224.66,5696.17,0]]],[[2291.04,2176.98,0],[[2308.31,2188.17,0],[2274.97,2168.82,0],[2284.76,2179.28,0]]],[[2431.3,1145.24,0],[[2452.27,1153.52,0]]],[[2512.85,5422.1,0],[[2526.7,5421.98,0]]],[[2620.11,614.338,0],[[2610.23,625.728,0]]],[[2593.91,5477.27,0],[[2603.46,5463.07,0]]],[[2630.84,4929.87,0],[[2644.6,4936.17,0]]],[[2716.47,3837.38,0],[[2740.17,3834.08,0],[2691.88,3846.02,0],[2722.35,3833.74,0]]],[[2714.12,3826.84,0],[[2722.35,3833.74,0],[2702.54,3817.08,0],[2719.41,3820.71,0]]],[[2701.14,5361.69,0],[[2686.02,5364.74,0],[2691.46,5369.79,0],[2714.11,5356.64,0]]],[[2740.17,3834.08,0],[[2770,3832.66,0],[2716.47,3837.38,0],[2732.63,3827.83,0]]],[[2744.53,3811.51,0],[[2730.69,3817.43,0],[2761.8,3803.78,0],[2737.22,3814.96,0]]],[[2788.58,3718.86,0],[[2785.64,3724.39,0]]],[[2822.04,5919.38,0],[[2831.53,5924.92,0],[2807.88,5911.49,0],[2830.63,5923.69,0]]],[[2831.83,6104.95,0],[[2849.46,6094.12,0]]],[[2865.06,5977.73,0],[[2869.76,5987.12,0],[2857.67,5965.66,0],[2868.37,5976.92,0]]],[[2907.53,4949.41,0],[[2917.37,4956.64,0],[2911.54,4938.89,0],[2892.2,4946.44,0]]],[[2929.31,5940.52,0],[[2911.98,5950.87,0]]],[[2938.64,6016.76,0],[[2948.74,6033.28,0]]],[[2948.74,6033.28,0],[[2938.64,6016.76,0],[2959.79,6047.72,0],[2944.51,6036.54,0]]],[[2966.67,6205.82,0],[[2979.79,6205.97,0]]],[[2988.01,1889.68,0],[[2992.21,1894.26,0]]],[[2991.89,1979.48,0],[[3011.39,1996.76,0],[2968.68,1961.84,0],[3003.72,1984.2,0]]],[[2986.9,5837.57,0],[[2958.4,5843.17,0],[3009.14,5832.92,0],[2993.02,5841.58,0]]],[[3007.05,6137.89,0],[[3008.52,6129.54,0],[3008.71,6146.69,0],[3010.1,6144.58,0]]],[[3038.75,5926.22,0],[[3050.4,5923.37,0],[3034.69,5918.55,0],[3034.98,5936.7,0]]],[[3021.01,6030.75,0],[[2999.87,6028.83,0],[3055.73,6034.07,0],[3022.84,6028.14,0]]],[[3134.42,1597.84,0],[[3144.07,1616.06,0],[3119.87,1578.76,0],[3128.01,1591.89,0]]],[[3128.76,5949.52,0],[[3131.61,5943.92,0]]],[[3115.89,6036.14,0],[[3102.88,6035.83,0]]],[[3189.2,5911.27,0],[[3204.16,5896.63,0],[3173.6,5922.33,0],[3184.93,5910.04,0]]],[[3204.16,5896.63,0],[[3218.23,5881.68,0],[3189.2,5911.27,0],[3208.37,5891.86,0]]],[[3200.45,6833.96,0],[[3208.04,6832.53,0]]],[[3232.07,5829.91,0],[[3224.44,5846.16,0],[3242.46,5819.61,0],[3226.97,5838.31,0]]],[[3253.27,5864.17,0],[[3273.28,5863.09,0],[3246.45,5865.24,0],[3251.69,5864,0]]],[[3246.45,5865.24,0],[[3253.27,5864.17,0],[3234.84,5870.44,0],[3239.03,5863.56,0],[3251.69,5864,0]]],[[3292.01,5783.51,0],[[3304.56,5781.27,0],[3292.19,5780.84,0],[3292.39,5781.51,0]]],[[3297.92,5742.56,0],[[3300.79,5754.74,0],[3294.82,5731.19,0],[3298.07,5745.92,0]]],[[3297.84,5772.31,0],[[3292.19,5780.84,0],[3301.34,5763.38,0],[3298.01,5776.36,0]]],[[3327.58,5790.31,0],[[3320.82,5780.36,0],[3318.12,5782.2,0],[3333.56,5797.24,0]]],[[3346.78,5762.89,0],[[3353.22,5755.2,0],[3348.39,5766.57,0],[3340.93,5770.13,0],[3341.97,5768.24,0]]],[[3331.36,5773.68,0],[[3340.93,5770.13,0],[3310.8,5777.92,0],[3336.48,5770.9,0]]],[[3389.54,5734.09,0],[[3407,5722.07,0],[3388.63,5734.38,0],[3393.18,5731.24,0],[3383.67,5741.32,0]]],[[3401.11,5654.61,0],[[3396.09,5657.17,0]]],[[3420.49,5648.67,0],[[3427.21,5646.74,0]]],[[3435.74,5642.92,0],[[3427.21,5646.74,0],[3448.92,5634.04,0],[3441.92,5638.43,0]]],[[3446.4,5705.23,0],[[3468.67,5705.63,0],[3433.67,5705.97,0],[3451.61,5705.12,0]]],[[3459.55,2633.49,0],[[3459.38,2612.9,0],[3451.56,2655.87,0],[3459.43,2640.14,0]]],[[3482.49,5617.26,0],[[3464.73,5624.75,0],[3500.94,5610.46,0],[3478.16,5621.91,0]]],[[3480.5,5657.51,0],[[3479.63,5675.37,0],[3479.2,5636.13,0],[3480.39,5649.17,0]]],[[3480.02,5641.99,0],[[3480.39,5649.17,0],[3481.46,5632.82,0],[3476.91,5642.86,0]]],[[3479.63,5675.37,0],[[3473.28,5699.95,0],[3480.5,5657.51,0],[3477.32,5682.75,0]]],[[3463.07,5725.33,0],[[3470.42,5710.76,0],[3456.41,5742.81,0],[3467.26,5720.77,0]]],[[3487.68,5706.42,0],[[3481.38,5709.08,0],[3492.79,5704.44,0],[3486.65,5705.16,0]]],[[3456.41,5742.81,0],[[3463.07,5725.33,0],[3447.53,5756.82,0],[3459.31,5739.91,0]]],[[3518.7,5603.8,0],[[3500.94,5610.46,0],[3534.1,5596.03,0],[3526.07,5603.2,0]]],[[3500.94,5610.46,0],[[3482.49,5617.26,0],[3518.7,5603.8,0],[3502.15,5610.03,0]]],[[3492.79,5704.44,0],[[3487.68,5706.42,0],[3481.8,5703.41,0],[3506.08,5700.5,0]]],[[3551.77,4905.4,0],[[3555.49,4895.44,0],[3539.22,4913.8,0],[3574,4895.48,0]]],[[3530.28,4918.5,0],[[3539.22,4913.8,0]]],[[3563.37,5569.95,0],[[3555.05,5577.44,0],[3577.52,5563.29,0],[3557.96,5572.12,0]]],[[3568.95,5599.29,0],[[3562.63,5598.01,0],[3556.78,5599.19,0],[3580.92,5600.44,0]]],[[3606.73,5603.63,0],[[3580.92,5600.44,0],[3625.32,5606.26,0],[3616.39,5605.42,0]]],[[3644.13,5608.29,0],[[3625.32,5606.26,0],[3659.53,5610.23,0],[3648.97,5612.96,0],[3665.9,5610.74,0]]],[[3619.69,5634.82,0],[[3634.41,5622.53,0],[3605.12,5646.75,0],[3617.17,5636.52,0]]],[[3665.9,5610.74,0],[[3681.3,5613.23,0],[3644.13,5608.29,0],[3659.53,5610.23,0]]],[[3775.64,4783.02,0],[[3782.39,4768.4,0],[3774.51,4798.39,0],[3766.45,4772.67,0]]],[[3827.4,4686.17,0],[[3814.64,4702.24,0],[3849.89,4668.18,0],[3824.89,4681.99,0]]],[[3830.16,5526.25,0],[[3811.43,5528.88,0],[3847.92,5530.13,0],[3837.08,5527.69,0]]],[[3843.34,5555.38,0],[[3853.61,5544.98,0],[3830.3,5567.73,0],[3848.91,5551.25,0]]],[[3878.79,5527.74,0],[[3868.21,5539.18,0],[3888.33,5513.52,0],[3878.4,5526.02,0]]],[[3995.61,3452.46,0],[[4004.89,3449.06,0],[3972.81,3440.75,0],[4001.67,3454.62,0]]],[[4069.99,5405.78,0],[[4079.4,5413.68,0],[4062.26,5396.19,0],[4077.1,5410.73,0]]],[[4092.79,5437.56,0],[[4078.91,5457.33,0],[4101.98,5418.66,0],[4094.46,5436.88,0],[4087.89,5441.89,0]]],[[4073.14,6335.09,0],[[4080.19,6341.68,0],[4049.59,6334.83,0],[4076.44,6331.33,0]]],[[4098.38,5339.86,0],[[4092.19,5339.91,0]]],[[4107.7,5400.97,0],[[4101.98,5418.66,0],[4117.61,5384.22,0],[4105.13,5403.46,0]]],[[4160.88,3308.29,0],[[4157.6,3318.82,0]]],[[4179.84,5342.53,0],[[4154.35,5356.92,0],[4198.25,5334.56,0],[4182.78,5340.91,0]]],[[4190.48,5335.03,0],[[4182.78,5340.91,0],[4198.28,5325.93,0],[4195.68,5336.95,0]]],[[4198.25,5334.56,0],[[4179.84,5342.53,0],[4209.52,5331.26,0],[4194.79,5336.89,0]]],[[4215.68,5338.12,0],[[4205.7,5336.85,0],[4222.98,5342.58,0],[4209.52,5331.26,0]]],[[4233.5,3557.37,0],[[4254.22,3569.88,0],[4207.1,3543.24,0],[4224.65,3553.14,0]]],[[4230.17,5311.91,0],[[4224.41,5311.87,0]]],[[4246.74,5347.88,0],[[4239.98,5347.98,0]]],[[4279.79,3701.74,0],[[4285.27,3709.68,0],[4274.4,3686.56,0],[4277.87,3715,0]]],[[4332.18,3783.71,0],[[4325.8,3775.78,0]]],[[4394.65,6763.42,0],[[4389.68,6767.99,0],[4385.85,6748.61,0],[4397.73,6772.28,0]]],[[4453.46,4266.68,0],[[4449.49,4292.39,0],[4455.5,4243.99,0],[4456.02,4263.71,0]]],[[4504.99,6794.69,0],[[4504.11,6783.91,0]]],[[4627.74,5879.08,0],[[4634.43,5887.23,0],[4614.1,5881.32,0],[4640.19,5873.42,0]]],[[4663.07,4381.1,0],[[4682.18,4389.71,0],[4649.18,4373.33,0],[4673.41,4385.87,0]]],[[4662.3,5866.17,0],[[4683.16,5859.38,0],[4640.19,5873.42,0],[4654.43,5868.2,0]]],[[4783.75,4387.96,0],[[4769.9,4381.23,0]]],[[4983.54,5419.23,0],[[4993.53,5421.12,0]]],[[5022.95,4534.31,0],[[5034.57,4552.68,0],[5008.41,4519.34,0],[5020.35,4525.65,0]]],[[5030.93,5883.95,0],[[5030.16,5876.85,0]]],[[5168.83,5005.33,0],[[5182.42,5013.77,0]]],[[5247.64,5818.98,0],[[5257.64,5820.18,0],[5239.86,5812.63,0],[5242.23,5814.39,0]]],[[5277.37,5163.73,0],[[5262.38,5187.34,0],[5288.55,5141.79,0],[5280.93,5162.43,0]]],[[5284.61,5335.78,0],[[5301.39,5351.24,0],[5269.08,5328.82,0],[5278.41,5330.04,0]]],[[5359.6,3797.27,0],[[5362.9,3805.94,0]]],[[5527.5,4718.07,0],[[5536.76,4723.74,0]]],[[5705.32,5286.92,0],[[5710.78,5276.21,0],[5697.82,5297.49,0],[5705.18,5291.48,0]]],[[6015.93,4958.55,0],[[6035.3,4954.18,0],[5999.61,4969.35,0],[6006.03,4958.15,0]]],[[6051.42,5598.14,0],[[6044.32,5600.36,0]]],[[6310.8,5135.6,0],[[6301.55,5115.99,0],[6318.71,5148.14,0],[6309.37,5134.23,0]]],[[6456.45,5306.36,0],[[6445.43,5294.64,0],[6467.04,5318.88,0],[6456.65,5304.23,0]]],[[6485.15,5376.75,0],[[6475.29,5367.17,0]]],[[6499.31,4940.78,0],[[6487.22,4954.91,0]]],[[6550.8,5084.84,0],[[6544.61,5099.46,0],[6557.92,5071.88,0],[6551.16,5076.99,0]]],[[6580.93,5191.94,0],[[6568.93,5192.79,0]]],[[6584.5,5323.69,0],[[6569.14,5319.56,0]]]];
private _startPoint = getPos player;
private _finalPoint = [4473.54,4278.46,0];
private _route = [];
private _routeDistance = 0;

comment "PUSH THE FIRST POINT";
_route pushBack _startPoint;

comment "FIND FIRST ROAD";
private _nearRoads = player nearRoads worldSize;
private _nearRoadsDistances = [];
{
	private _distance = player distance _x;
	_nearRoadsDistances pushBack _distance;
} forEach _nearRoads;
private _nearestRoadDistance = selectMin _nearRoadsDistances;
private _nearestRoadIndex = _nearRoadsDistances find _nearestRoadDistance;
private _nearestRoad = _nearRoads select _nearestRoadIndex;
private _nearestRoadPosition = (getPos _nearestRoad);
_route pushBack _nearestRoadPosition;

comment "FIND NEXT HEAD ARRAY";
private _DT_fnc_findHead = {
	params ['_startPosition'];
	private _headDistances = [];
	{
		_x params ['_headPoint','']; 
		_headDistances pushBack (_startPosition distance _headPoint);
	} forEach _allMapPoints;
	private _nearestHeadDistance = selectMin _headDistances;
	private _nearestHeadArrayIndex = _headDistances find _nearestHeadDistance;
	_nearestHeadArrayIndex
};
comment "FIND CLOSEST CROSSPOINT";
private _DT_fnc_findCross = {
	params ['_crossPoints'];
	private _crossDistances = [];
	{
		_crossDistances pushBack (_startPosition distance _finalPoint);
	} forEach _crossPoints;
	private _nearestCrossDistance = selectMin _crossDistances;
	private _nearestCrossPointIndex = _crossDistances find _nearestCrossDistance;
	private _nearestCrossPoint = _crossPoints select _nearestCrossPointIndex;
	_nearestCrossPoint
};

comment "CYCLE THROUGH ALL ROUTE";
private _startPosition = _nearestRoadPosition;
private _passedPoints = [];
while {true} do {
	private _nearestHeadArrayIndex = [_startPosition] call _DT_fnc_findHead;
	private _nearestHeadArray = _allMapPoints select _nearestHeadArrayIndex;
	if (_nearestHeadArray in _passedPoints) exitWith {};
	_nearestHeadArray params ['_headpoint','_crossPoints'];
	private _nearestCrossPoint = [_crossPoints] call _DT_fnc_findCross;
	_startPosition = _nearestCrossPoint;
	_passedPoints pushBack (_allMapPoints deleteAt _nearestHeadArrayIndex);
	_route pushBack _headpoint;
	_route pushBack _nearestCrossPoint;
};

comment "GENERATE MARKERS";
{
	private _marker = createMarker [format["test_%1",_forEachIndex],_x];
	_marker setMarkerColor "ColorBlack";
	_marker setMarkerType "hd_dot";
} forEach _route;
